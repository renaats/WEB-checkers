<!DOCTYPE html>
<html>
    <body style="background-color: #e7e3e3">
        <h1>Draughts</h1>
        <form action="/play" method="get">
            <button onclick="incrementCookie()">Play!</button>
        </form>
        <p><span id="gamesPlayed">Unknown</span> Games Played!</p>
        <p><span id="movesMade">Unknown</span> Moves Made!!!</p>
        <p><span id="playersOnline">Unknown</span> Players Ingame!</p>
        <p>You Played <span id="yourGames">Unknown</span> Games!</p>
    </body>



    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script>
        document.addEventListener("load", reload());
        function incrementCookie() {
            var playCount = getCookie("playCount");
            if(playCount==""){
                document.cookie = "playCount = 1; expires=Thu, 18 Dec 2020 12:00:00 UTC";
            }
            else
            {
                playCount = parseInt(getCookie("playCount"));
                playCount++;
                document.cookie = "playCount = "+ playCount +"; expires=Thu, 18 Dec 2020 12:00:00 UTC";
            }
        };
        function reload() {
            $.get("/updateStats/").done(function(res) {
                console.log(res);
                document.getElementById("gamesPlayed").innerHTML = res.gamesPlayed;
                document.getElementById("movesMade").innerHTML = res.movesMade;
                document.getElementById("playersOnline").innerHTML = res.playersOnline;
                if(getCookie("playCount")=="")
                    document.getElementById("yourGames").innerHTML = "0";
                else
                    document.getElementById("yourGames").innerHTML = getCookie("playCount");
            });
        };

        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i <ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
                }
            }
            return "";
        }
    </script>
</html>